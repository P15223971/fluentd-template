# DO NOT EDIT - this file is templated. See scripts/ directory
<filter pingfed.audit.auditLogin>
  @type record_transformer
  enable_ruby
  <record>
    Action ${record['Action'].strip}
    severity ${record['Outcome'].gsub(/FAILURE|SUCCESS/,'FAILURE' => 'WARN', 'SUCCESS' => 'INFO')}
    Hostname ${hostname}
  </record>
  remove_keys Message,Test,severity
</filter>

 <source>
  @type tail
  path /opt/ping-federate/log/audit/auditLogin.log
  pos_file /etc/google-fluentd/pos/auditLogin.pos
  tag pingfed.audit.auditLogin
  time_format %Y-%m-%d %H:%M:%S
  <parse>
    @type regexp
    expression /^(?<time>\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2})\s+(?<Environment>([^ ]+))\s+\|\s+(?<Event>([^\|]+))\|(?<User>([^\|]+))\|(?<Action>([^\|]+))\|(?<CPID>([^\|]+))\|(?<DaonID>([^\|]+))\|(?<Outcome>([^\|]+))\|(?<Message>([^\n]+))/</parse>
</source>
